## 论

### 医学统计学的定义

医学统计学是用统计学的原理和方法研究医学领域中数据的收集、整理、分析和结果正确解释与表达的一门科学。

医学统计学提供各种统计方法帮助人们透过许多偶然现象，分析、判断和阐明事物的内在规律性。

作为科学工具的统计学的重要性就在于**能够通过分析样本数据对未知的总体作出推断。**

### 数据描述的方法

对数的理解并对其作出任何推断的第一步是要了解所要处理的数据属何种类型，因为不同的数据类型需要用不同的统计方法来分析。实际工作中非统计学家有时会很容易忽略它。

#### 分类数据

当一个病人的病情或他的某些状况能够分成几种类别时，对他们的观测可以产生分类数据（有时也称为二分类或定性数据）。

比如：

如一个病人对肿瘤治疗是否有反应、吸烟还是不吸烟，或这个病人是否患有结肠癌等。这种类型的数据有时被称为二分类或0-1变量数据。

三分类或更多分类的数据有如血型（A、B、AB、O）；复合分类如男性或女性白血病和非白血病病人。

#### 连续性数据

连续性数据通常是指通过测量得到的数据，如体重、气温、血压和大多数血液化学检验的数据（如胆红素、血红素、胆固醇）。

这些观测或它的转换值（如对数转换值、平方根转换值）通常认为是服从正态分布的。

#### 比

当我们取两个变量的比值时就产生了比数据。

例如排除率（一个重要的心脏功能指数），是指心脏舒张末期容量的差值同心脏收缩末期容量之比。

#### 连续性比例数据

它实际上是当比为0到1的百分数时的一种比值数据的子类型，例如，与基线相比不同时间肾功能降低的百分比，关于某些生理变量及分子或基因靶体在治疗前后变化的百分比。

#### 重复测量



#### 删失数据

当我们不能精确地测量一个观测，而仅仅知道这个观测是超过一定的阈值时，就称这个观测被删失。

医学研究中最常见的删失数据是生存数据，就是到一定事件发生时的时间长度数据，这事件可以是病毒感染，或病人的死亡。

由于以下几个原因，生存数据的分析常需要特殊的方法。

首先，生存数据的分布不是对称的，因此也不服从正态分布，在建模时用其他的分布会更加满意；

第二，在分析时间数据时常有某些病人的生存终点还没有被观测到，甚至某些病人的生存状态由于失访而无法知道。

### 统计学中的基本概念

#### 同质与变异

**同质**是指观察单位（研究个体）间被研究指标的**主要影响因素相同或基本相同**

**同质的个体间各种指标存在差异，这种差异称为变异。**

统计学的任务就是在同质的基础上，对个体变异进行分析研究，揭示由变异所掩盖的同质事物内在的本质和规律。

变异的概念始终贯穿于统计学理论与实践中，它是我们的日常生活、我们的数据以及由数据所得到的统计估计中所固有的。由于人和人之间是不同的，即便是非常好的药物与治疗方法也可能仅对一些病人有效，而对另一些人无效。

实际上，如何控制由于不同可能的因素而造成的变异正是统计实验设计的任务。变异的统计估计可以使我们定量地确定生物医学研究结果中的不确定性。这些知识在实际工作中可以用来决定病人的治疗策略。这种努力的目标是基于遗传学信息来达到个体化用药。

#### 总体与样本

总体是根据研究目的所确定的同质观察单位某项变量值的集合（全体）。

样本是从总体中随机抽取有代表性的部分观察单位变量值的集合。

#### 参数与统计量

总体的统计指标被称为参数（parameter），样本的统计指标被称为统计量（statistic）。

#### 误差

* 非随机误差

  非随机误差主要是指系统误差（systematic error）。系统误差是指在收集资料的过程中，由于仪器不准确、标准不规范等原因，造成观察结果呈倾向性的偏大或偏小，即具有方向性的误差。系统误差影响原始资料的准确性，在收集资料前必须消除。

- 随机误差

  随机误差（random error）是一类不恒定的、随机变化的误差，往往使实测值无方向性地围绕着某一数值左右波动。它主要分为以下两种：

  - 随机测量误差
  - 抽样误差

#### 概率

概率（`probability`）是描述随机事件发生可能性大小的量值，常用符号 $P$ 表示。概率的取值范围在$0～1$之间，即 $0≤P≤1$ 。不可能发生的事件，则概率$P=0$；必然发生的事件，则概率$P=1$。



### 频数表

频数，即次”数”， 指变量值中代表某种特征的数出现的次数。

#### 频数表的形式

![image-20210914150058124](./img/07-%E5%8C%BB%E5%AD%A6%E7%BB%9F%E8%AE%A1%E5%AD%A6%E5%9F%BA%E7%A1%80/image-20210914150058124.png)

- **频数**　将所有变量值通过划记逐个归入相应组段
- **频率**　频数表中的各组频数之和等于总例数，将各组的频数除以总数后得到的值被称为频率。
- **累计频率** 累计频数等于该组段及前面各组段的频数之和，累计频率等于累计频数除以总例数，

#### 频数表的用途

- 揭示资料的分布类型
- 观察资料的集中趋势和离散趋势
- 便于发现某些特大或特小的可疑值
- 便于计算统计指标和进一步作统计处理

### 集中趋势的描述

#### 算数平均

- 直接法　
  $$
  \bar{X}=\frac{\sum X}{n}
  $$
  例：某护士测得 $7$ 名正常男子红细胞数（$10^{12}/L$）如下：$4.67，4.74，4.77，4.88，4.76，4.72，4.92$，求其均数。
  $$
  \bar{X}=\frac{4.67+4.74+4.77+4.88+4.76+4.72+4.92}{7}=\frac{33.46}{7}=4.78\left(10^{12} / \mathrm{L}\right)
  $$

- 加权法

  将组中值 $X$ 分别与该组频数 $f$$相乘，近似地等于该组变量值之和 $$fX$.
  $$
  \bar{X}=\frac{f_{1} X_{1}+f_{2} X_{2}+\cdots+f_{k} X_{k}}{f_{1}+f_{2}+\cdots+f_{k}}=\frac{\sum f X}{\sum f}
  $$

#### 几何均数

- 直接法　直接将n个变量值（$X_1，X_2，X_3，…，X_n$）的乘积开$n$次方:

  
  $$
  G=\sqrt[n]{X_{1} \cdot X_{2} \cdot X_{3} \cdots X_{n}}
  $$
  

  写成对数形式为：
  $$
  G=\lg ^{-1}\left(\frac{\lg X_{1}+\lg X_{2}+\cdots \lg X_{n}}{n}\right)=\lg ^{-1}\left(\frac{\sum \lg X}{n}\right)
  $$
  
- 加权法

  参考算数均值加权法：
  $$
  G=\lg ^{-1}\left(\frac{\sum f \lg X}{\sum f}\right)
  $$
  

#### 中位数

- 直接法

  - $n$ 为奇数时
    $$
    M=X _\frac{n+1}{2}
    $$
    
  - $n$ 为偶数时
    $$
    M=\left[X_{\frac{n}{2}}+X_{\left(\frac{n}{2}+1\right)}\right] / 2
    $$
  
- 频数表法
  $$
  M=L+\frac{i}{f_{m}}\left(\frac{n}{2}-\sum f_{L}\right)
  $$
  式中$L$为中位数所在组段的下限，$i$为该组段的组距，$f_m$为该组段的频数，$∑f_L$为小于$L$的各组段累计频数。

#### 百分位数

百分位数不是平均数，而是一种位置指标，以$P_X$表示
$$
P_{X}=L+\frac{i}{f_{X}}\left(n \cdot X \%-\sum f_{L}\right)
$$
式中$f_X$为$P_X$所在组段的频数，$i$为该组段的组距，$L$为该组段下限，$∑f_L$为小于$L$的各组段累计频数。

### 离散趋势的描述

#### 极差

极差（range，简记为$R$）亦称**全距**，即一组变量值中最大值与最小值之差，反映变量值的离散范围。

#### 四分位数间距

极差的不稳定主要受两端值的影响，如果将两端数据各去掉一部分，这样所得的数据比较稳定。例如，两端各去掉$25%$，取中间$50%$的数据，这样可先计算$P_{25}$和$P_{75}$，求出$P_{75}$与$P_{25}$之差，即为**四分位数间距**（quartile interval，简记为$Q$）。
$$
Q=P_{75}-P_{25}
$$

#### 方差

总体中每个变量值$X$与总体均数$μ$，之差的和，即$∑（X-μ）$，称为**离均差和**。由于$X-μ$有正有负，即$∑（X-μ）=0$，这样仍不能反映总体离散度大小，故计算$∑（X-μ）^2$，称为离均差平方和。由于$∑（X-μ）^2$的大小与总体中变量值的个数$N$的多少有关，为了消除$N$的影响，取其均数即为方差（variance），总体方差用$σ^2$表示。即
$$
σ^2 = \frac{\Sigma(X-\mu)^2}{N}
$$
实际工作中经常得到的是样本资料，$μ$是未知数，只能用样本均数来估计。按公式（12）算得样本方差平均比$σ^2$偏小，所以统计学家建议用$n-1$代替$n$来校正，于是计算样本方差$S^2$的公式为：
$$
S^2= \frac{\Sigma(X-\bar{X})^2}{n-1}
$$


#### 标准差

虽然方差可以较全面地反映变量值的变异情况，但是方差的单位是原单位的平方，将方差开方即得标准差（standard deviation），它与原始变量值单位相同。总体标准差用$σ$表示
$$
\sigma=\sqrt{\frac{\Sigma(X-\mu)^2}{N}}
$$
样本标准差用$S$表示。
$$
S=\sqrt{\frac{\Sigma{（X-\bar{X}})^2}{n-1}}
$$
从标准差计算公式可以看出，当各变量值越接近均数时，标准差就越小；当各变量值越远离均数时，标准差就越大。所以标准差可以更完善地说明一组变量值之间的离散程度。

标准差的计算方法可分为直接法和加权法。

直接法，代入公式（15）直接运算即可：
$$
S=\sqrt{\frac{\Sigma(X^2-\frac{(\Sigma{X})^2}{n})}{n-1}}
$$

> 
> $$
> \Sigma(X-\frac{\Sigma X}{n})^2 
> &= \Sigma(X^2 - 2X\frac{\Sigma X}{n} + (\frac{\Sigma X}{n})^2) \\ 
> &= \Sigma (X^2-\frac{(\Sigma X)^2}{n})
> $$
> 

加权法　当变量值较多时，和加权法计算均数一样，首先列出频数分布表，用下式计算标准差。
$$
S=\sqrt{\frac{\Sigma fX^2-\frac{(\Sigma fX)^2}{\Sigma f}}{\Sigma f - 1}}
$$

### 变异系数

对于对称分布资料，特别是正态分布资料，**标准差反映变量值的绝对离散程度**。当两组或多组变量值的单位不同或均数相差较大时，不能或不宜用两个或多个标准差的大小来比较其离散程度。为此引入反映**变量值的相对离散程度**的指标，即变异系数（coefficient of variation，简记为CV），样本变异系数CV的计算公式为：
$$
CV=\frac{S}{X} \times 100\%
$$


### 正态分布

#### 正态分布的概念和特征

特征为：频数分布以均数为中心，左右基本对称，靠近均数两侧的频数较多，而两侧距均数较远时，频数逐渐减少。

![image-20210915144717910](./img/07-%E5%8C%BB%E5%AD%A6%E7%BB%9F%E8%AE%A1%E5%AD%A6%E5%9F%BA%E7%A1%80/image-20210915144717910.png)

正态分布的密度函数，即正态曲线的方程为：
$$
f(X)=\frac{1}{\sigma\sqrt{2\pi}}e^{-\frac{1}{2}(\frac{X-\mu}{\sigma})^2}, -\infin<X<+\infin
$$

- $\mu$总体均数，描述了正态分布的集中趋势位置，故称为位置参数。
- $\sigma$总体标准差，描述了正态分布的离散程度，$σ$越小，分布越集中，曲线的形状越“高瘦”；$σ$越大，分布越离散，曲线的形状越“矮胖”，故$σ$称为形状参数或离散度参数。

该式中仅有$X$为变量，当$X$取定值时就可由此式求得其密度函数$f(X)$的函数值，即相应纵坐标高度。

![image-20210915172911326](./img/07-%E5%8C%BB%E5%AD%A6%E7%BB%9F%E8%AE%A1%E5%AD%A6%E5%9F%BA%E7%A1%80/image-20210915172911326.png)



#### 正态曲线下面积

正态曲线下一定区间的面积，可以通过对其密度公式求积分得到：
$$
F(X)=\int_{-\infin}^X{\frac{1}{\sigma\sqrt{2\pi}}e^{-\frac{1}{2}(\frac{X-\mu}{\sigma})^2}}dX 
$$

## 总体均数的区间估计和假设检验

### 统计推断

当总体中的个体数无穷多时，总体随时间和空间不断变化，不可能直接获得总体参数。即使对有限总体来说，若研究方法具有破坏性且用于研究的技术力量、设备条件和资金不足等情况下，研究总体也是不必要或不可能的。

在多数情况下，只能借助于从总体中随机抽取足够数量的有代表性的样本，通过样本信息来了解总体情况。

从总体中随机抽取部分有代表性的样本，用样本统计量（如样本均数$\bar{X}$、样本率$p$）来推断总体参数（如总体均数μ、总体率π）的方法称为抽样研究（sampling study），通过样本信息推断总体特征。此过程称为统计推断。

### 标准误

若从正态总体$N（μ，σ^2）$中，反复多次随机抽取样本含量固定为$n$的$k$个样本，那么这$k$个样本均数$\bar{X_i}$也以$μ$为中心服从正态分布。即便是从非正态总体中随机抽样，当$n$足够大时，其均数$\bar{X_i}$也呈现近似正态分布。

样本均数的标准差称为均数的标准误，简称为标准误（standard error），用$\sigma_{\bar{X}}$来表示。$\sigma_{\bar{X}}$是反映均数抽样误差大小的指标。

> 标准误，即为算数/几何平均数的标准差。

$$
\sigma_{\bar{X}} = \frac{\sigma}{\sqrt{n}}
$$

由于在实际工作中，总体标准差$σ$往往未知，而是用样本标准差$S$来代替$σ$，故只能求得标准误的估计值，其计算公式为：
$$
S_{\bar{X}} = \frac{S}{\sqrt{n}}
$$
标准误反映了样本均数间的离散程度，也反映了样本均数与总体均数的差异，即抽样误差的大小。

同类性质的资料，标准误越小，表示样本均数与总体均数越接近，也就是抽样误差越小，说明样本均数推论总体均数的可靠性越大；反之，标准误越大，说明抽样误差越大，说明用样本均数推论总体均数的可靠性越小。

###  $t$分布

正态变量X采用$Z=（X-μ）/σ$变换，则一般的正态分布$N（μ，σ）$即变换为标准正态分布$N（0，1）$。

又因从正态总体抽取的样本均数$\bar{X}$服从正态分布$N(\mu, \sigma_{\bar{X}})$，同样可作正态变量的$Z$变换，即

## 参考资料

[1] [景学安，孔浩 - 《医学统计学（第2版）》](https://www.amazon.cn/dp/B07DWYCCWB)

